import{s as Q,z as H,u as J,r as c,y as K,d as O,i as B,o as l,c as n,f as d,a as e,t as r,w as D,B as X,F as b,l as S,h as Y,k as Z,j as C,g,D as w,q as y,x as ee,m as se}from"./index-Hfj1Gs7U.js";import{a as L,n as p}from"./axios-efjzW8l8.js";import{u as te}from"./cart-tXYMpkQy.js";import{A as ae,N as oe,P as le,a as U,S as q}from"./autoplay-qYVK0XaC.js";import{P as R}from"./ProductCard-T1nvJF5u.js";const ie={class:"container"},ne=ee('<nav style="--bs-breadcrumb-divider:&#39;&gt;&#39;;" aria-label="breadcrumb" class="mt-3"><ol class="breadcrumb"><li class="breadcrumb-item"><a class="link-secondary fs-5 text-decoration-none" href="#/products">產品列表</a></li><li class="breadcrumb-item text-success fw-bold fs-5" aria-current="page">產品資訊</li></ol></nav>',1),ce={key:0},re={class:"row"},de={class:"col-md-6"},ue=["src","alt"],ve={class:"col-md-6 d-flex flex-column"},pe={class:"fs-1 fw-bold mb-3"},_e={class:"badge bg-success rounded-pill fs-6 mb-3"},me={class:"fs-5 my-3"},fe={class:"h4"},he={class:"fs-6 mb-3"},be={class:"mb-2 mt-auto"},ge={class:"input-group"},we=["disabled"],ye=e("option",{default:"",disabled:""},"請選擇數量",-1),ke=["value"],xe=["disabled"],Pe=e("hr",null,null,-1),Se={class:"row mt-3"},Ce={class:"col-lg-8 col-12"},$e=e("p",{class:"fs-4 fw-bold"},"商品資訊：",-1),Ne={class:"fs-5"},Ve=e("br",null,null,-1),ze=e("p",{class:"fs-4 fw-bold"},"保存方式：",-1),Te={class:"fs-5"},Ge=e("hr",null,null,-1),Be=e("p",{class:"fs-2 fw-bold text-center my-5"},"相關商品",-1),De={class:"swiper-container position-relative"},Le={key:0},Ue=e("i",{class:"bi bi-chevron-compact-left fs-1 text-dark"},null,-1),qe=[Ue],Re=e("i",{class:"bi bi-chevron-compact-right fs-1 text-dark"},null,-1),Me=[Re],We={key:1},je=e("i",{class:"bi bi-chevron-compact-left fs-1 text-dark"},null,-1),Ae=[je],Ee=e("i",{class:"bi bi-chevron-compact-right fs-1 text-dark"},null,-1),Fe=[Ee],Xe={__name:"ProductPage",setup(Ie){const $=te(),{createCart:M,updateCart:W,getCart:N}=$,{cart:k}=Q($),x=H(),j=J(),u=c(!1),f=c(!1),v=c(1),t=c({}),_=c([]),m=c(null),h=c(window.innerWidth),V=[ae,oe,le],z=c(!1),A=a=>{j.push(`/product/${a.id}`)};K(()=>x.params.id,()=>{G(x.params.id)});const T=a=>{m.value=a},G=()=>{f.value=!0,L.getProduct(x.params.id).then(a=>{t.value=a.data.product,E()}).catch(a=>{p(!1,a.response.data.message),f.value=!1})},E=()=>{L.getProducts(1,t.value.category).then(a=>{_.value=a.data.products,z.value=!0,f.value=!1}).catch(a=>{p(a.response.data.message)})},F=async()=>{u.value=!0;const a=k.value.carts.findIndex(i=>i.product_id===t.value.id),o={data:{product_id:t.value.id,qty:v.value}};if(a!==-1){const i=k.value.carts[a].qty+v.value,P=k.value.carts[a].id;o.data.qty=i,await W(P,o).then(s=>{p(!0,`${t.value.title}${s.data.message}`),u.value=!1}).catch(s=>{p(!1,`${s.response.data.message}`)}),await N(),v.value=1}else await M(o).then(i=>{p(!0,`${t.value.title}${i.data.message}`),u.value=!1}).catch(i=>{p(!1,`${i.response.data.message}`)}),await N(),v.value=1};return O(()=>{G(),window.addEventListener("resize",()=>{h.value=window.innerWidth})}),(a,o)=>{const i=B("myLoading"),P=B("font-awesome-icon");return l(),n(b,null,[d(i,{active:f.value},null,8,["active"]),e("div",ie,[ne,t.value?(l(),n("div",ce,[e("div",re,[e("div",de,[e("img",{class:"img-fluid object-fit-cover w-100 mb-2",src:t.value.imageUrl,alt:t.value.title,style:{"max-height":"400px"},"data-aos":"zoom-in"},null,8,ue)]),e("div",ve,[e("h4",pe,r(t.value.title),1),e("div",null,[e("span",_e,r(t.value.category),1)]),e("p",me,"尺寸/包裝："+r(t.value.description),1),e("div",fe,"售價：NT$ "+r(t.value.price)+" 元",1),e("del",he,"原價：NT$ "+r(t.value.origin_price)+" 元",1),e("div",be,[e("div",ge,[D(e("select",{class:"form-select",id:"inputGroupSelect02","onUpdate:modelValue":o[0]||(o[0]=s=>v.value=s),disabled:u.value},[ye,(l(),n(b,null,S(10,(s,I)=>e("option",{value:s,key:I},r(s),9,ke)),64))],8,we),[[X,v.value]]),e("button",{disabled:u.value,type:"button",class:"btn btn-success",onClick:o[1]||(o[1]=s=>F())},[D(d(P,{icon:"spinner",class:"fa-spin"},null,512),[[Y,u.value]]),Z(" 加入購物車 ")],8,xe)])])])]),Pe])):C("",!0),e("div",Se,[e("div",Ce,[$e,e("p",Ne,r(t.value.content),1),Ve,ze,e("p",Te,r(t.value.presever),1)])]),Ge,Be,e("div",De,[z.value?(l(),n("div",Le,[d(w(q),{autoplay:!1,loop:_.value.length>4||h.value<992,modules:V,"slides-per-view":1,breakpoints:{768:{slidesPerView:2,slidesPerGroup:1},992:{slidesPerView:4,slidesPerGroup:1}},"space-between":10,onSwiper:T},{default:g(()=>[(l(!0),n(b,null,S(_.value,s=>(l(),se(w(U),{key:s.id},{default:g(()=>[d(R,{product:s,onGoToDetail:A},null,8,["product"])]),_:2},1024))),128))]),_:1},8,["loop"]),_.value.length>4||h.value<992?(l(),n("a",{key:0,href:"#",class:"position-absolute top-50 start-0",style:{"z-index":"100"},onClick:o[2]||(o[2]=y(s=>m.value.slidePrev(),["prevent"]))},qe)):C("",!0),_.value.length>4||h.value<992?(l(),n("a",{key:1,href:"#",class:"position-absolute top-50 end-0",style:{"z-index":"100"},onClick:o[3]||(o[3]=y(s=>m.value.slideNext(),["prevent"]))},Me)):C("",!0)])):(l(),n("div",We,[d(w(q),{autoplay:!0,loop:!0,modules:V,pagination:{clickable:!0},"slides-per-view":1,breakpoints:{768:{slidesPerView:2,slidesPerGroup:1},992:{slidesPerView:4,slidesPerGroup:1}},"space-between":10,onSwiper:T},{default:g(()=>[(l(),n(b,null,S(6,s=>d(w(U),{key:s.id},{default:g(()=>[d(R,{imgUrl:s.imageUrl,title:s.title,price:s.price,category:s.category},null,8,["imgUrl","title","price","category"])]),_:2},1024)),64))]),_:1}),e("a",{href:"#",class:"position-absolute top-50 start-0",style:{"z-index":"100"},onClick:o[4]||(o[4]=y(s=>m.value.slidePrev(),["prevent"]))},Ae),e("a",{href:"#",class:"position-absolute top-50 end-0",style:{"z-index":"100"},onClick:o[5]||(o[5]=y(s=>m.value.slideNext(),["prevent"]))},Fe)]))])])],64)}}};export{Xe as default};
