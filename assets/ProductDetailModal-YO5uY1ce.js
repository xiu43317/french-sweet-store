import{_ as M,r as b,s as T,i as I,o as S,c as C,a as t,t as c,D as j,w as P,h as D,f as k,j as q,p as B,b as Q,d as L,M as V,I as U,F as E,l as F}from"./index-invxNhHQ.js";import{u as N}from"./cart-Qp5udG6S.js";import{n as m}from"./axios-N3QjHTje.js";const A={props:["product"],setup(i,a){const u=N(),e=b(!1),{getCart:l,updateCart:p,createCart:o,changeAddStatus:s}=u,{cart:n,addBtnState:_}=T(u),h=b(null),v={...i.product};return{isSpinning:e,cartStore:u,addToCart:async()=>{const g=v.title;e.value=!0,s(!0);const f=n.value.carts.findIndex(r=>r.product_id===v.id),d={data:{product_id:v.id,qty:1}};if(f!==-1){const r=n.value.carts[f].qty+1,y=n.value.carts[f].id;d.data.qty=r,await p(y,d).then(x=>{m(!0,`${g}${x.data.message}`)}).catch(x=>{m(!1,x.response.data.message)}),await l()}else await o(d).then(r=>{m(!0,`${g}${r.data.message}`)}).catch(r=>{m(!1,r.response.data.message)}),await l();e.value=!1,s(!1)},goToDetail:()=>{a.emit("go-to-detail",v)},updateCart:p,createCart:o,tempProduct:v,productModal:h,addBtnState:_,changeAddStatus:s,getCart:l,cart:n}}},G=i=>(B("data-v-d80f741b"),i=i(),Q(),i),R={class:"position-relative bg-img"},z=["src"],H=G(()=>t("div",{class:"title-bg position-absolute w-100 top-0 d-flex justify-content-center align-items-end"},[t("p",{class:"text-white fs-3 fw-bold"},"查看內容")],-1)),J={class:"card-body"},K={class:"mb-3"},O={class:"bg-success text-white py-1 px-2 rounded"},W={class:"card-title fs-4"},X={class:"card-text fs-5"},Y=["disabled"];function Z(i,a,u,e,l,p){const o=I("font-awesome-icon");return S(),C("div",{class:"card h-100",onClick:a[1]||(a[1]=s=>e.goToDetail())},[t("div",R,[t("img",{src:e.tempProduct.imageUrl,class:"card-img-top img-fluid object-fit-cover",alt:"...",style:{height:"250px"}},null,8,z),H]),t("div",J,[t("div",K,[t("span",O,c(e.tempProduct.category),1)]),t("h5",W,c(e.tempProduct.title),1),t("p",X," NT$ "+c(e.tempProduct.price),1),t("button",{class:"btn btn-outline-secondary w-100",onClick:a[0]||(a[0]=j(s=>e.addToCart(),["stop"])),disabled:e.addBtnState},[P(k(o,{icon:"spinner",class:"fa-spin"},null,512),[[D,e.isSpinning]]),q(" 加入購物車 ")],8,Y)])])}const Pt=M(A,[["render",Z],["__scopeId","data-v-d80f741b"]]),tt={props:["product"],setup(i){const a=N(),{createCart:u,updateCart:e,getCart:l}=a,{cart:p}=T(a);let o;const s=b(1),n=b(null),_=b({}),h=b(!1),v=()=>{_.value=i.product,o.show()},w=()=>{o.hide()},$=async()=>{h.value=!0;const g=p.value.carts.findIndex(d=>d.product_id===_.value.id),f={data:{product_id:_.value.id,qty:s.value}};if(g!==-1){const d=p.value.carts[g].qty+s.value,r=p.value.carts[g].id;f.data.qty=d,await e(r,f).then(y=>{m(!0,`${_.value.title}${y.data.message}`),h.value=!1,w()}).catch(y=>{m(!1,`${y.response.data.message}`)}),await l(),s.value=1}else await u(f).then(d=>{m(!0,`${_.value.title}${d.data.message}`),h.value=!1,w()}).catch(d=>{m(!1,`${d.response.data.message}`)}),await l(),s.value=1};return L(()=>{o=new V(n.value),n.value.addEventListener("hidden.bs.modal",()=>{s.value=1})}),{myQty:s,tempProduct:_,modal:n,myModal:o,openModal:v,closeModal:w,createCart:u,updateCart:e,addToCart:$,getCart:l,isSpinning:h}}},et={class:"modal fade",id:"productModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},st={class:"modal-dialog modal-xl",role:"document"},at={class:"modal-content border-0"},ot={class:"modal-header bg-secondary text-white"},dt={class:"modal-title",id:"exampleModalLabel"},nt=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),ct={class:"modal-body"},it={class:"row"},lt={class:"col-md-6"},rt=["src"],ut={class:"col-md-6 d-flex flex-column justify-content-evenly"},pt={class:"badge bg-success rounded-pill fs-6 mb-3"},_t={class:"h5"},mt={class:"h6"},vt={class:"mt-3"},ft={class:"input-group"},ht=["disabled"],gt=t("option",{default:"",disabled:""},"請選擇數量",-1),bt=["value"],yt=["disabled"];function wt(i,a,u,e,l,p){const o=I("font-awesome-icon");return S(),C("div",et,[t("div",st,[t("div",at,[t("div",ot,[t("h5",dt,[t("span",null,c(e.tempProduct.title),1)]),nt]),t("div",ct,[t("div",it,[t("div",lt,[t("img",{class:"img-fluid object-fit-cover w-100 mb-2",src:e.tempProduct.imageUrl,alt:"",style:{"max-height":"400px"}},null,8,rt)]),t("div",ut,[t("div",null,[t("span",pt,c(e.tempProduct.category),1)]),t("p",null,"尺寸/包裝："+c(e.tempProduct.description),1),t("p",null,"商品資訊："+c(e.tempProduct.content),1),t("div",_t,"售價：NT$ "+c(e.tempProduct.price)+" 元",1),t("del",mt,"原價：NT$ "+c(e.tempProduct.origin_price)+" 元",1),t("div",vt,[t("div",ft,[P(t("select",{class:"form-select",id:"inputGroupSelect02","onUpdate:modelValue":a[0]||(a[0]=s=>e.myQty=s),disabled:e.isSpinning},[gt,(S(),C(E,null,F(10,(s,n)=>t("option",{value:s,key:n},c(s),9,bt)),64))],8,ht),[[U,e.myQty]]),t("button",{disabled:e.isSpinning,type:"button",class:"btn btn-outline-secondary",onClick:a[1]||(a[1]=s=>e.addToCart())},[P(k(o,{icon:"spinner",class:"fa-spin"},null,512),[[D,e.isSpinning]]),q(" 加入購物車 ")],8,yt)])])])])])])])],512)}const $t=M(tt,[["render",wt]]);export{Pt as P,$t as a};
